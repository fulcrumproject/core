get:
  tags:
    - Vault
  summary: Get secret value
  description: |
    Retrieves the actual value of a secret from the vault. This endpoint is only accessible to agents and allows them to resolve `vault://` references in service properties to retrieve the actual sensitive values.

    **Authorization**: Only agents can access this endpoint.

    **Use Case**: When an agent receives a service configuration with properties containing `vault://abc123` references, it calls this endpoint to retrieve the actual secret values needed for provisioning or managing the service.
  operationId: getSecret
  parameters:
    - name: reference
      in: path
      required: true
      description: The vault reference identifier (without the `vault://` prefix)
      schema:
        type: string
        example: abc123def456
  responses:
    "200":
      description: Secret value retrieved successfully
      content:
        application/json:
          schema:
            type: object
            required:
              - value
            properties:
              value:
                description: The actual secret value (can be any JSON type - string, number, object, array, boolean, null)
                example: "my-secret-password"
          examples:
            stringSecret:
              summary: String secret (API key)
              value:
                value: "sk_live_abc123xyz789"
            objectSecret:
              summary: Object secret (credentials)
              value:
                value:
                  username: "admin"
                  password: "secret123"
            numberSecret:
              summary: Number secret
              value:
                value: 12345
    "400":
      $ref: ../components/responses.yaml#/BadRequest
    "401":
      $ref: ../components/responses.yaml#/Unauthorized
    "403":
      description: Forbidden - only agents can access vault secrets
      content:
        application/json:
          schema:
            $ref: ../components/schemas/common.yaml#/ErrorRes
    "404":
      description: Secret not found
      content:
        application/json:
          schema:
            $ref: ../components/schemas/common.yaml#/ErrorRes
          example:
            status: "Not found"
            error: "Secret with reference 'abc123' not found"
    "500":
      $ref: ../components/responses.yaml#/InternalServerError
